---
layout: post
title: Create your first autonomous agents with copilot studio
description: 
date: 2025-07-28
image: https://raw.githubusercontent.com/holgerimbery/holgerimbery.blog/main/holgerimbery/images/2025/06/ed-hardie-RMIsZlv8qv4-unsplash.jpg
image_caption: Photo by <a href="https://unsplash.com/@edhardie?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Ed Hardie</a> on <a href="https://unsplash.com/photos/a-screenshot-of-a-phone-RMIsZlv8qv4?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a>
category: [copilotstudio, agent, authentication]
author: admin
featured: true
toc: true
---

## How to Build an Autonomous Email Response Agent with Copilot Studio

**Introduction**  
Imagine having a virtual assistant that can automatically handle incoming support emails, provide accurate answers, log each inquiry for record-keeping, and gracefully hand off to a human agent when needed. Microsoft **Copilot Studio** makes this possible by enabling the creation of **autonomous agents** – AI-powered assistants that combine generative AI with workflow automation. In this article, we’ll walk through how to create an autonomous email-response agent using Copilot Studio. Our example scenario is an IT support agent that manages emails about **Microsoft Dynamics 365 Customer Service**, **Dynamics 365 Contact Center**, and **Copilot Studio** itself. The agent will read incoming questions on these topics, respond with helpful answers, create an IT ticket in a SharePoint list for documentation, and **escalate to a human** if it cannot resolve the issue.

We'll cover the following: an overview of Copilot Studio’s capabilities, integrating it with Dynamics 365 systems, step-by-step configuration of the agent (including email handling and SharePoint logging), setting up escalation procedures, testing, and best practices. By the end, you’ll understand how to build a reliable autonomous agent that enhances support efficiency while knowing when to involve human experts.

---

## Understanding Copilot Studio and Autonomous Agents

**Copilot Studio** is Microsoft’s low-code platform for building intelligent agents (also known as copilots or chatbots) as part of the Power Platform. It provides a visual interface to design conversational AI behavior and integrate automation. Key features and capabilities include:

- **Low-Code Agent Builder:** Copilot Studio offers a graphical, no-code/low-code environment to create AI agents, including setting up conversation logic and connecting data sources. Much of the functionality you need for a chatbot or virtual agent is available *out-of-the-box*, which makes development intuitive[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio). For example, you can define the agent’s persona and instructions, and it will use generative AI (GPT-4) to understand user queries and formulate responses.

- **Knowledge Integration:** Agents can be powered by various **knowledge sources** without manual coding. You can connect an agent to enterprise content like SharePoint sites, internal wikis or documents, public websites, or Dataverse data. This means the agent can pull answers from existing documentation or knowledge bases. In fact, Copilot Studio allows adding knowledge sources such as **public websites, SharePoint, file uploads, Dataverse, or enterprise data via Graph connectors**[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot). This greatly improves the **quality** and accuracy of answers, as the agent’s responses are backed by trusted content. *(For our scenario, this means we could feed the agent with content about Dynamics 365 Customer Service and Contact Center – for instance, product FAQ pages or internal guides – so it can answer related questions confidently.)*

- **Generative AI with Control:** Copilot Studio agents use generative AI to converse naturally with users, but you can guide their behavior. You provide **agent instructions** (a system prompt defining its role and scope) and can create specific **topics** with trigger phrases for predictable flows. The agent uses these along with the connected knowledge to understand intent. If a query falls under a custom topic, it will execute that flow; otherwise, it will answer from its knowledge using generative AI. This hybrid approach ensures both **flexibility** (open-ended Q&A) and **determinism** (scripted actions for known tasks).

- **Agent Flows (Integrated Automation):** An **autonomous agent** isn’t just about answering questions – it can also **take actions** on the user’s behalf. Copilot Studio includes **Agent Flows**, which are essentially Power Automate workflows embedded into the agent. These flows enable the agent to perform back-end tasks like looking up information, updating records, or calling external services as part of the conversation. They can be triggered by the agent during dialogue or run on schedules/events. Agent Flows bring consistent, rule-based automation to the agent’s repertoire – for example, the same input will always produce the same automated outcome[3](https://learn.microsoft.com/en-us/microsoft-copilot-studio/flows-overview). You can design flows with triggers and actions using a visual editor or even natural language descriptions. In our example, we will use agent flows to integrate the email system and SharePoint (more on this soon).

- **Multi-Channel Deployment:** Agents built in Copilot Studio can be deployed across channels such as Microsoft Teams, web chat, or even embedded in SharePoint and other apps. This means users can interact with your agent in the platforms they already use. For instance, you can publish an agent as a Teams app for internal employees, or expose it on a website for customers. *(If needed, our email-handling agent could also be made accessible via a chat interface in addition to email.)*

- **Built-in Topic Management and Fallback:** Copilot Studio provides system topics for handling greetings, small talk, and crucially, **fallback and escalation**. If the agent doesn’t understand a query, it will attempt to clarify the user’s intent. By default, after two unsuccessful prompts to clarify, the agent will trigger an **Escalate** system topic to hand over to a human agent[4](https://learn.microsoft.com/en-us/microsoft-copilot-studio/authoring-system-fallback-topic). These system behaviors can be customized – we can modify what the agent does when it can’t handle a request (instead of just saying “I can’t help,” we might initiate our own escalation procedure).

- **Integration with Dynamics 365:** Copilot Studio is part of the Power Platform and shares the same Dataverse foundation as Dynamics 365 applications. This makes it easier to integrate with systems like Dynamics 365 Customer Service or the digital contact center. For example, a Copilot Studio agent can create or retrieve Dataverse records (cases, contacts, etc.) via agent flows, or even be used *within* a Dynamics 365 environment as a virtual agent. Microsoft has provided connectors so that the **Copilot in Dynamics 365 Customer Service** can use Copilot Studio’s knowledge sources to answer customer queries in Customer Service channels[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot)[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot). Additionally, if you use **Dynamics 365 Omnichannel for Customer Service** (the contact center platform), Copilot Studio agents can be configured to hand off chats to live agents in Omnichannel with full context transfer[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off)[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off). In short, Copilot Studio agents are designed to work hand-in-hand with Dynamics 365 systems – either by powering customer-facing self-service or by assisting human agents with AI suggestions.

**In summary, Copilot Studio enables you to build an intelligent agent that can understand natural language questions, draw from multiple data sources for answers, and perform automated tasks – all without writing code.** With those capabilities in mind, let’s design our email-based support agent.

---

## Integrating Copilot Studio with Dynamics 365 Customer Service and Contact Center

Before diving into the build process, it’s helpful to outline how our Copilot Studio agent can interface with the Dynamics 365 ecosystem:

- **Knowledge and Context:** Dynamics 365 Customer Service typically has a knowledge base for support articles, and agents often need data about customers or cases. Our Copilot agent can be given access to these knowledge materials without duplicating them. Using Copilot Studio’s knowledge connectors, we could integrate content from Dynamics 365 (for example, by connecting to a SharePoint where knowledge base articles are stored, or using Dataverse to pull knowledge articles). In fact, a preview feature allows Dynamics 365 Contact Center or Customer Service to directly use Copilot Studio-configured knowledge sources to improve an AI Copilot’s responses[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot)[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot). This means the information the agent uses to answer emails can be the same single source of truth used in your CRM system.

- **Performing CRM Actions:** Through **agent flows**, the Copilot can perform operations in Dynamics 365. For example, if a customer email asks “What’s the status of my support ticket 12345?”, our agent could use a flow to look up that Case in Dynamics 365 Customer Service and retrieve the status to include in its answer. Similarly, the agent could create a new Case record in Dynamics if desired. The agent flows leverage **Dataverse connectors** to read or write data in the Dynamics system. This is a powerful way to integrate live business data into the agent’s capabilities (beyond static knowledge). In our scenario, we will log issues to a SharePoint list instead of directly into Dynamics – but the principle is the same, and one could easily adapt it to create **Dynamics 365 Case records** as the “IT tickets” instead of SharePoint items.

- **Omnichannel Hand-off:** For organizations using Dynamics 365 as a contact center, a common requirement is seamless escalation from a bot to a human agent. Microsoft Copilot Studio agents can be configured for **live hand-off** using Omnichannel for Customer Service. If the Copilot is published as part of a Customer Service environment, an escalation can transfer the conversation and all context to an available support representative in the Omnichannel queue[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off). In practice, this means that if our agent can’t answer an email or the user is unsatisfied, the issue could be routed into the agent desktop for a human to follow up. However, since our scenario is specifically about email, a “live chat” handoff isn't directly applicable – instead, escalation will likely notify a human to take over the email thread or call the user. We’ll implement that via a ticket and notification. (If we extended this solution to chat or Teams, the same agent could directly escalate the active conversation to a live agent using the built-in **Escalate** topic with an Omnichannel transfer step.)

- **Dynamics 365 Contact Center Integration:** The newly introduced **Dynamics 365 Customer Service/Contact Center** platform includes a digital contact center capability, where an AI Copilot suggests answers and knowledge to human agents. It’s worth noting that Copilot Studio agents can also serve as **employee-facing assistants**. For instance, a support agent working in Dynamics 365 could ask our Copilot Studio agent (through Teams or an integrated UI) to get information or draft a response. This is similar to how Microsoft’s Sales Copilot and Customer Service Copilot work. One real-life example is a banking company that integrated a Copilot Studio agent with a non-Microsoft contact center, pulling together data from Dataverse and Azure, to help their employees handle customer inquiries more efficiently[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25)[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25). In that solution, the agent was accessible via an employee portal and could quickly retrieve info from internal knowledge (offers, process docs, regulatory info, etc.) to assist the contact center staff[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25).

In summary, Copilot Studio agents are very flexible in a Dynamics 365 context: they can both serve customers directly (by answering queries automatically via email or chat), and assist human agents (by surfacing knowledge or taking over routine tasks). Now, let’s focus on building our email-handling autonomous agent step by step.

---

## Building the Autonomous Email Agent: Step-by-Step

Our goal is to create an agent that monitors a support email inbox and responds to inquiries about Dynamics 365 Customer Service, Dynamics 365 Contact Center, and Copilot Studio. It will also document each interaction and handle escalation. We’ll break the process into steps:

### 1. **Set Up the Copilot in Copilot Studio**

**Creating the Agent:** Start by navigating to the Copilot Studio portal (https://copilotstudio.microsoft.com) and create a new agent. You can choose a template if one fits (Copilot Studio offers pre-built agent templates), or start from scratch. For our scenario, a blank agent or a Q&A bot template would work. Give the agent a clear name (e.g., “Dynamics Support Copilot”) and description.

**Defining the Agent’s Role:** In Copilot Studio, you’ll configure the agent’s core *instructions*. This is often referred to as the system prompt or persona for the AI. For example, you might write: *“You are an autonomous support agent assisting Contoso Ltd employees with questions about Microsoft Dynamics 365 Customer Service, Dynamics 365 Contact Center, and Copilot Studio. You answer incoming emails politely and helpfully using our company’s knowledge base. If you can’t confidently answer a question, you will escalate it to a human support agent.”* These instructions set the tone and boundaries for the AI. Copilot Studio also allows you to set a Friendly name and an avatar icon for the agent, which can be useful if the agent interacts through channels like Teams or web chat.

**Adding Knowledge Sources:** Next, empower the agent with the information it needs to answer questions. In the Copilot Studio interface, there is a **Knowledge** section where you can add sources. For our agent, add content that covers Dynamics 365 Customer Service, Contact Center, and Copilot Studio topics. You might use a combination of sources such as: 

- *Public documentation websites:* For example, you can add Microsoft Learn articles or docs.microsoft.com URLs related to Dynamics 365. Copilot Studio will crawl these and use them to formulate answers. (Ensure you add only relevant, high-quality URLs so the agent doesn’t get confused or stray beyond intended topics.) 

- *Internal SharePoint or Files:* If your organization has internal documentation (e.g., a PDF guide to using the contact center software, or a DOCX FAQ), you can upload those or point the agent to a SharePoint document library. The agent will then have that data available when answering. 

- *Dataverse or Enterprise data:* In some cases, you might connect to a Dataverse table containing reference info (though for our scenario, product documentation is more likely in docs or web form). 

Adding multiple knowledge sources is supported, and Copilot Studio will index them for semantic search. **The quality of these sources is critical** – remember the adage “garbage in, garbage out.” Providing accurate and up-to-date information ensures the agent’s responses are reliable[7](https://learn.microsoft.com/en-us/power-platform/architecture/solution-ideas/agent-custom-contact-center). You may also assign names or descriptions to each knowledge source; for instance, label them “Product Docs” vs “Internal FAQ” so the agent can cite or differentiate if needed.

*(By integrating these knowledge sources, our agent will be able to answer detailed questions such as “How do I configure queues in Dynamics 365 Contact Center?” or “What is Copilot Studio used for?” by pulling the answer from the official documentation or internal guides, just as a human expert would.)*

**Topic Configuration (Optional):** Copilot Studio uses a concept of **topics** to handle structured dialog flows. In an autonomous agent scenario, you might rely mostly on the generative AI to handle open Q&A. But it’s still wise to configure some topics:
- For example, a **Greeting** topic to handle when someone first emails (though in email, the user usually just asks their question without “hello” – in chat this is more relevant).
- A topic for **Fallback/Escalation** (we will definitely customize the Escalation, in step 4).
- If you anticipate certain multi-step interactions, you could create topics for them. For instance, if the agent were to guide the user through a procedure (“let’s troubleshoot your issue step by step”), that could be a topic. In our email scenario, interactions are likely one-question-at-a-time, so custom topics might be minimal.

**Agent Settings:** Lastly, review any settings like language (our agent will communicate in the language of the user’s email, presumably English), and enable “Autonomous actions” if available. Autonomous mode ensures the agent can use actions/flows automatically when needed. Copilot Studio might have an option to allow the agent to trigger flows as part of generative answers (for example, if the user asks something that requires an action, the agent can decide to call the action). We want the agent to be allowed to create tickets autonomously, so such settings should be enabled.

### 2. **Configuring Email Handling via Agent Flows**

Our agent lives in Copilot Studio, but it needs to interface with the **email channel**. Currently, Copilot Studio agents can be published to interactive channels like Teams or embedded in web pages. Email is an asynchronous channel, so we will use an **Agent Flow** to connect Outlook with our agent:
 
**Overview of the Email Flow:** We will create an agent flow that triggers when a new support email arrives, passes the email content to the Copilot agent for processing, and then sends out the agent’s reply. All of this will happen behind the scenes, so to the end user it feels like they emailed a helpdesk and “got a reply from the AI assistant.”

Key steps in the flow (we’ll implement these shortly):
1. **Trigger:** *When a new email arrives* in the designated mailbox (e.g., support@contoso.com or an IT helpdesk inbox). We can filter this trigger to certain folders or subjects if needed, but generally it will trigger on any new email query.
2. **Action – Invoke Copilot Agent:** Take the email’s subject and body, and send them to the Copilot Studio agent as a user query. There might be a specific action/connector for Copilot Studio or we can use a workaround such as posting the content to the agent through a Teams interface. One pattern from Copilot Studio’s documentation is to use an agent flow to *send a message to the agent* to initiate processing[8](https://learn.microsoft.com/en-us/power-platform/architecture/reference-architectures/document-processing-agent). In fact, Microsoft’s reference architecture for an autonomous document-processing agent shows an agent flow monitoring an inbox and sending a message like “Process the document: <ID>” to the agent when a file arrives[8](https://learn.microsoft.com/en-us/power-platform/architecture/reference-architectures/document-processing-agent). In our case, the message could simply be the email query itself forwarded to the agent. The agent will then generate a response as if it were answering a user in a chat.
3. **Action – Send Email Reply:** Once the agent formulates an answer, our flow will take that answer text and send an email back to the original sender. We’ll make the email appear to come from the support agent (it could be the same mailbox or an alias like “Contoso Copilot <copilot@contoso.com>”). The Outlook connector in Power Automate can send an email. We should include the agent’s answer in the body, and possibly a polite sign-off. For example, the reply might say: “Hello [User],\n\n[Agent’s answer]\n\nRegards,\nContoso Virtual Support Assistant”.
4. **Action – Log the interaction:** We’ll cover this in the next step, but essentially the flow will also create a record of the Q&A in our SharePoint list (or any ticketing system).

To implement the above, go to the **Flows** section in Copilot Studio (within your agent’s project) and create a new agent flow. You can use the natural language builder by typing something like: *“When a new email arrives in the IT Support inbox, have the agent answer it and send a reply, then record the details in SharePoint.”* Copilot Studio’s AI might generate a draft flow with these steps, which you can refine.

Let’s break down the components of the flow:

- **Trigger Setup:** Use the **Outlook email** trigger (the Office 365 Outlook connector’s event for new email). You’ll need to sign in or use a connection for the mailbox that will receive the support emails. For example, choose “When a new email arrives (V3)” trigger. Set the parameters like the folder (Inbox) and any conditions (maybe only emails sent to a specific alias, if the mailbox handles multiple things). This trigger will fire for each incoming email message.

- **Call the Agent:** At the next step, we want the agent to process the email text. One straightforward approach is to use the **Copilot Studio connector** action “Run a flow from Copilot” or similar, but that is intended for agent calling flows, not flows calling agent. Instead, we leverage the **agent’s ability to accept messages via triggers**. We can do this by creating a special topic or by using a built-in action:
  
  Copilot Studio potentially provides an action to **post a message** to the agent and get a response (similar to how a chat interface would). If such an action is not directly available, an alternative is to use the **Bot Framework** or **Direct Line API** for the bot. However, since our focus is on within Copilot Studio, an easier way is:
  
  - Use a **Dataverse table** as an intermediary: for example, add a row to a “Pending Emails” table and have a Dataverse trigger in Copilot Studio (agent flow) that picks it up and sends to agent. But this is complex.
  
  A simpler and documented method is to utilize **Power Virtual Agents integration** – Copilot Studio agent is essentially a Power Virtual Agent behind the scenes. We could call the PVA’s endpoint via an HTTP action. Another approach: If the agent is deployed to Microsoft Teams (as a chatbot), we might automate sending a Teams message to it. But that requires a Teams user context.

  For brevity, let’s assume Copilot Studio will introduce an easier direct action. In our scenario, since the architecture reference shows it’s possible, we’ll say: *The agent flow sends the email content as a message to the Copilot agent for processing*. This triggers the agent to generate an answer. (During this step, the agent uses its AI and knowledge sources to compose the reply.)

- **Capture Agent’s Response:** The agent’s response needs to be retrieved in the flow. Copilot Studio might handle this by continuing the flow after the agent responds (for example, if we call the agent within the flow, the next action can use the agent’s output). In a dialog, the agent’s answer would normally go to the user; here we intercept it. One way could be that the flow calls an action node in the bot which returns data. Another could be that the agent’s message is stored in a variable or sent to the flow as output of the “invoke agent” action. We will assume the flow can get the text of the answer.

- **Send Email Response:** Now use an **Outlook “Send email”** action. Populate the **To** field with the original sender’s email (accessible from the trigger data). Set a subject, perhaps reusing the original subject or something like “RE: [original subject]”. In the body, insert the agent’s answer text. You might also add some greeting (“Hi, ...”) and signature as mentioned. It’s wise to clearly identify that this is an automated assistant’s answer, or use a friendly name to set expectations. However, since this is internal (for employees asking IT), they likely know it’s an AI assistant from the context. Still, transparency is good practice (“This answer was provided by our Virtual Assistant.”). Optionally, CC the IT support team or a logging address if you want humans to see all outgoing replies.

- **(Optional) Include References or Links:** If the agent pulled information from certain documents, you might want it to cite sources or provide links in the email (for example, “According to the Dynamics 365 documentation [link]...”). Copilot Studio agents can provide such references especially if knowledge source is a website. Make sure the formatting is email-friendly.

Now, a potential challenge: **acting on behalf of the user**. If the agent needs to send email *as* a particular person or on behalf of someone, credentials and permissions come into play. In our design, the agent will reply from a system mailbox, not as the original asker. This is simpler. (In a forum question, one user attempted to have the agent send emails in the user’s name and ran into authentication issues[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25)[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25). It’s generally easier to use a no-reply or generic account for the bot.)

At this point, the flow has taken the incoming email, gotten an AI-generated answer, and sent a reply. Next, we log the ticket.

### 3. **Creating IT Tickets in a SharePoint List**

Logging each interaction in a SharePoint list will serve as our lightweight ticketing system and knowledge log. Let’s set up a SharePoint list (if not already existing) called “IT Support Tickets” or similar. It should have columns to capture relevant data from the email and the agent’s actions. For example:

- **Title** – a brief title of the issue, perhaps the email subject line or a summary.
- **Requester** – person who sent the email (we can use their email address or name).
- **Issue Details** – the content of the query (could be the full email body, or a cleaned-up version).
- **Agent Response** – what answer the copilot provided.
- **Status** – e.g., “Answered by AI” or “Escalated”.
- **Timestamp** – date/time logged.
- **Escalation Notes** – if escalated, maybe store info here such as who it was assigned to or why.

These are just suggestions; tailor the list to your needs. Ensure the account running the flow has permission to add items to this list.

Now, back in our agent flow, after sending the email response, add a **SharePoint – Create item** action (using the SharePoint connector). Point it to the site and list we created. Map the fields:
- Title = email subject (for instance).
- Requester = email sender (the trigger provides sender’s address; we can also use Microsoft Graph to get their display name if needed).
- Issue Details = perhaps the first 250 characters of the email or the whole body (if it's not too large).
- Agent Response = the text the agent sent in the reply.
- Status = “Resolved” (if answered) or “Escalated” (we will handle escalation soon, it might require a conditional branch).
- Timestamp = use expression `utcNow()` or the trigger time.

By logging these items, the IT team now has a record of what questions are coming in and how the bot answered. This can be useful for later review; for example, support staff can periodically audit these to ensure the AI gave correct answers or to identify topics that the AI struggled with.

Logging also helps with **metrics**: you can count how many issues were handled by the AI (a measure of deflection) versus how many were escalated to humans. Copilot Studio’s analytics and the SharePoint list together can provide that insight.

*(Note: In a production scenario, one might use a more robust ITSM system or Dynamics 365 Customer Service to log tickets, but SharePoint is perfectly fine for our example. The approach is similar if using another system – just call the appropriate connector or API in the flow to create a ticket in ServiceNow, Dynamics, etc.)*

### 4. **Implementing Escalation to a Human Agent**

No matter how good our autonomous agent is, there will be questions it cannot answer or situations where it should not attempt to (for instance, complex, account-specific issues or unhappy users demanding a person). We need to plan for **escalation**: handing the issue off to a human support technician.

**When to Escalate:** By default, Copilot Studio will trigger the **Escalate** system topic after the fallback tries (when it cannot interpret the query)[4](https://learn.microsoft.com/en-us/microsoft-copilot-studio/authoring-system-fallback-topic), or immediately if the user explicitly asks for a human (like typing "I want to talk to a person"). Additionally, we might decide to escalate based on the content of the question or the AI’s confidence. For example, if the agent’s answer is essentially “I’m not sure” or it has to give a very generic apology, that should be treated as a failure to answer, and escalate. We can detect this in our flow by checking the agent’s response text – if it contains a phrase we know is the fallback message, then mark it for escalation.

**Customizing the Escalation Topic:** In Copilot Studio’s Topics > System, open the **Escalate** topic. By default, in agents not linked to an engagement hub, this topic might simply send a message like “Connecting you to a support representative...” and end. We can edit this. Since in email we can’t “transfer conversation” in real-time, we will use the escalation topic to do two things:
  1. Tell the user that their request will be handled by a human.
  2. Invoke a procedure to notify the human team.

For instance, we can change the Escalate topic’s message node to: *“I’m sorry I couldn’t assist you fully. I am escalating your request to a human support agent who will reach out to you shortly.”* This text will be included in the email reply to the user in escalation cases.

Next, in the Escalate topic’s flow (in Copilot Studio), we can add an **action** node to create a support ticket or notify a team. One option is using the **Transfer to agent** node which is meant for live chat handoff, but if we’re not using Omnichannel, we might instead add a **Power Automate flow action** here. Copilot Studio allows calling a cloud flow from a topic (it can pass context variables to the flow). We could create a separate flow that sends an alert email to the IT team or updates the SharePoint item status. However, since we already have our main agent flow, it may be simpler to handle escalation logic entirely in that flow:

In the main flow, after the agent generates a response, we branch: if the response is a normal answer, we proceed to email it and mark ticket as answered; if the response indicates escalation (or if the agent hit the Escalate topic internally), then:
- We still might email the user (with the escalate message saying someone will help).
- The SharePoint ticket status = “Escalated”.
- Notify the support team: possibly send them an email like “Copilot could not answer [Issue Title] for [User]. Please follow up.” along with the question details. We can easily do this with another Outlook action addressed to the support group or create a Teams message etc.

Another approach is to have the **Escalate topic call a self-service action** to create a ticket. Microsoft’s guidance suggests using a Power Automate action in the bot to create a support ticket with all details when escalation happens[9](https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/deflection-alternate-escalation-paths)[9](https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/deflection-alternate-escalation-paths). In our case, the “ticket” is the SharePoint item, which we are already creating. We could enhance it by adding a field “EscalationNeeded” and set it via the flow. 

For demonstration, let’s say: if escalation is needed, the flow will update the SharePoint item’s **Status** to “Escalated” and also send an email notification to a human. That human (maybe the IT helpdesk lead) can then take the original email or the info from SharePoint and respond manually. The agent’s involvement ends there (aside from having already informed the user of escalation).

**Integration with Dynamics (optional):** If we wanted, at escalation we could automatically create a **Case in Dynamics 365 Customer Service** or a ticket in an ITSM system. This is absolutely possible via an agent flow action (just like we create a SharePoint item, we could create a new Case record in Dataverse and assign it to a queue). Dynamics 365 would then handle it like any other support case. Copilot Studio’s escalate topic can be configured to transfer the conversation to Dynamics 365 Omnichannel seamlessly if we had that channel set up[7](https://learn.microsoft.com/en-us/power-platform/architecture/solution-ideas/agent-custom-contact-center) – the conversation transcript would appear in the omnichannel agent’s dashboard, so they see what the user asked and what the bot attempted. This is ideal for live chat; for email, creating a Case and attaching the conversation history might be the analogous approach.

For now, our solution will stick to notifying via email/SharePoint since it’s simpler. The key is: **the user should not be left hanging.** They should get a reply (even if from the bot) that a human will help, and the human team should get a clear alert to take over.

### 5. **Testing the Agent and Workflow**

With the agent built and the flow configured, it’s crucial to thoroughly **test** the entire setup before deploying broadly. Here are some steps and best practices for testing:

- **Agent Dry-Run in Studio:** Use Copilot Studio’s built-in test chat to simulate a few queries. Copilot Studio allows you to chat with the agent in a test panel. Ask it sample questions about Dynamics 365 to see if it responds correctly from the knowledge sources. For instance, “What is the Dynamics 365 Customer Service module used for?” or “How do I add users to a queue in Contact Center?”. This helps verify that the knowledge integration is working and the answers make sense. If the agent struggles to answer something that you know is in the documents, you may need to adjust the knowledge source or instructions (perhaps add a FAQ entry or ensure the wording matches what users might ask).

- **Trigger the Flow with a Test Email:** Send an actual email to the support inbox as a test user. Compose a question that you expect the agent to handle. Then monitor: the flow should trigger (you can check the Power Automate run history for success/failure), the agent should generate a reply, and you (the sender) should receive an email back with the answer. Check the SharePoint list to see if a ticket entry was created correctly with the right info. This end-to-end test confirms the whole chain is working: Outlook -> Agent -> Outlook, plus logging.

- **Test Edge Cases:** Try an email that the agent likely **cannot** answer or that should cause escalation. For example, ask a very ambiguous question or something off-topic, like “Can you help me fix my coffee machine?” (assuming that’s outside the Dynamics scope defined in agent instructions). The agent should follow the fallback path. After two prompts or so, it will escalate. Verify that in this case, the reply you get says it’s being escalated, and that the SharePoint entry is marked escalated and an alert was sent. This ensures your escalation logic catches the right condition. Also test an email where the user explicitly says “I need a human” or “I’m not happy with that answer” (possibly in a follow-up email). The agent should not get stuck in a loop – it should promptly escalate when asked. Copilot Studio’s default escalate topic specifically listens for such phrases and triggers handoff[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off), so ensure that path works via email as well (the user might reply "please escalate", and perhaps you route that to escalate logic).

- **Multi-turn Context:** One tricky aspect is if the user replies to the bot’s answer with another question. Since this is email, each email is somewhat a separate session unless we program context tracking. Our current design treats each incoming email independently. This means if a user responds to the bot’s answer with “Actually, I meant in the on-prem version.”, the agent won’t remember the previous Q&A unless we feed the email thread history into it. For a simpler implementation, you could state that the user should always ask a complete question. But if continuity is needed, you might enhance the flow to include previous conversation context (like search the SharePoint log or email thread and provide that to the agent as well). This is advanced, so initially we might document that each email should be a self-contained query for best results.

- **Load Testing:** If expecting a large volume of emails, test how the system handles multiple incoming emails in a short span. Agent flows consume Copilot Studio capacity per action[3](https://learn.microsoft.com/en-us/microsoft-copilot-studio/flows-overview)[3](https://learn.microsoft.com/en-us/microsoft-copilot-studio/flows-overview), so monitor the usage. The platform is designed to handle concurrent runs, but you should be mindful of any rate limits (e.g., email connector might have sending limits, and Copilot may queue requests if too many come simultaneously).

- **User Acceptance Testing:** If possible, have a few end users pilot the system. Let some colleagues send typical questions and gather their feedback on the helpfulness of answers and the tone. Ensure the answers are not only correct but also **clear and polite**, matching support’s style. Fine-tune the agent’s language if needed (you can update the instruction prompt to adjust tone, e.g., more formal vs casual).

### 6. **Deployment and Monitoring**

Once testing is successful, you can deploy the solution for real use:

- **Deploying the Agent:** In Copilot Studio, publish the agent. For our email scenario, “publishing” really just means the agent (and its flows) are active and can be invoked. We don’t have an interactive UI for users to click; the entry point is the email trigger. Still, ensure the agent is in a production environment (with proper licensing for Copilot Studio and any connectors used).

- **Go Live on Email:** Make sure the support email address is communicated to the user base (if not already). Users will start sending inquiries. Initially, maybe route only specific topics or a subset of users to the bot while confidence builds.

- **Monitor Operations:** This is crucial. Track how the agent is performing. There are multiple ways:
  - **SharePoint Logs:** The list we set up is a simple dashboard of all handled tickets. Review it periodically. Look at the questions and answers. Are the answers correct? How many were escalated? If you see an answer that seems off or an escalation that could have been answered, go back to Copilot Studio and improve the knowledge or logic.
  - **Copilot Studio Analytics:** Microsoft provides analytics for agents (like session counts, resolution rates, escalation rates, etc.). Copilot Studio likely logs conversations and allows you to see transcripts. Check the analytics to quantify things like deflection rate – i.e., what percentage of inquiries the bot handled without human help. The ideal scenario is a high deflection rate, meaning fewer escalations. If the deflection rate is lower than expected, see what those cases are and if the bot can be enhanced to handle them.
  - **Application Insights (Optional):** For advanced monitoring, integrate the agent with Azure Application Insights. The reference architecture for large deployments suggests using App Insights for real-time telemetry of the agent’s performance[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25)[7](https://learn.microsoft.com/en-us/power-platform/architecture/solution-ideas/agent-custom-contact-center). If you set this up, you can get alerts on errors (e.g., if the flow failed to send an email) and track usage patterns over time in a centralized way. This might be overkill for a small scenario, but it’s good for scaling up.
  - **User Feedback:** Provide a way for users to give feedback on the answers. Since it’s email, you could add a line in the signature like “Was this answer helpful? [Yes/No]”. If they reply or click, you can capture that. Even without formal feedback, any escalations implicitly mean the user wasn’t satisfied (since either the bot didn’t know, or the user wasn’t content with the answer). Use that as feedback to improve. Over time, aim to reduce those by updating the agent.

- **Iterative Improvement:** Treat this AI agent as a continually learning system. Update its knowledge sources regularly (for example, if new documentation for Dynamics is released, or if the company adds new internal processes, make sure the agent knows about them). Also update the **agent’s instructions and topics** as you observe real conversations. You might find users often phrase a particular question in a way the bot doesn’t catch; adding a custom topic or some alternate phrasing to the knowledge could help. Copilot Studio might offer suggestions for uncovered topics via its analytics (like showing what questions had no good match).

- **Security and Compliance Check:** Now that it's live, ensure it meets your organization’s security requirements. ABN AMRO Bank, for instance, conducted a thorough security review for Copilot Studio in their adoption and found it met strict requirements including data residency, DLP, compliance standards, etc.[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio). Ensure that your agent only has access to the intended data (for example, the SharePoint list might contain possibly sensitive info from emails – set proper permissions on it). The agent itself will follow the security context of the environment; only those with access to the Copilot Studio environment can modify it. For user data privacy, since the content of support emails is now being processed by AI, ensure this is disclosed if necessary within your org’s policies, and that you are not violating any regulations (usually internal support queries are fine, but if any personal data is included, treat it carefully). One advantage is that the data stays within your tenants (Copilot Studio uses your Azure/Dataverse backend), and you’re not sending these emails to a third-party service openly. All interactions can be logged for audit if needed.

---

## Best Practices and Considerations

To ensure the success of your autonomous agent project, keep in mind these best practices and considerations:

**1. Maintain High-Quality Knowledge:** The effectiveness of the agent is directly tied to the quality of information it has. Curate the knowledge sources – remove any outdated or irrelevant content that might confuse the AI. If pulling from public docs, try to scope it to the relevant sections (for example, don’t load the entire Dynamics 365 documentation, perhaps just the specific modules of interest). Regularly update the sources so the agent keeps up with product updates or new internal policies. *Remember:* providing rich, accurate data to the agent yields more reliable answers[7](https://learn.microsoft.com/en-us/power-platform/architecture/solution-ideas/agent-custom-contact-center).

**2. Clarity in Agent Instructions:** Be explicit in the agent’s persona instructions about what it should and shouldn’t do. E.g., “Only answer questions related to these products. If asked something else (like personal data or unrelated topics), either redirect or politely decline.” We saw in the Document Processing agent example that the agent was instructed to ignore requests outside its scope[8](https://learn.microsoft.com/en-us/power-platform/architecture/reference-architectures/document-processing-agent). Such constraints help prevent the AI from wandering off-topic or making up answers about things it doesn’t know. Also, instruct it on escalation triggers: e.g., “If the user is not satisfied or the answer is not known, escalate.”

**3. Tone and Formatting:** Define the tone of voice that matches your support culture – perhaps friendly and concise. An AI response in an email should be well-formatted: use bullet points or numbered steps if explaining a procedure, rather than one big paragraph. You might want the agent to include a greeting (“Hi [Name],”) and a sign-off. You can incorporate a template for that either in the flow (wrapping the agent’s pure answer text) or in the agent’s response generation (via prompt engineering). Doing a few sample Q&A and adjusting for tone will ensure the agent’s emails sound professional and helpful.

**4. Escalation Workflow:** Decide what happens when something is escalated. We have our SharePoint ticket and an email notification to humans. Ensure there’s a human process to monitor those. For instance, if the IT support team uses Microsoft Teams, consider also posting a message to a Teams channel for escalations (Power Automate can do this). Clearly define SLA: if the bot escalates, a human should respond within X hours. You may even have the bot mention that “you can expect a response within X timeframe” to set expectations. Microsoft’s Copilot Studio allows customizing the escalate topic to maybe give a link or reference number[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off); we could include the SharePoint ID as a ticket number in the message to the user: “Ticket #123 has been logged for you.”

**5. Privacy and Permissions:** Ensure the agent only accesses what it should. For example, if connecting to Dynamics data, use a service account with limited read scope. For the SharePoint list, maybe restrict it from containing extremely sensitive info since multiple people may see it. If users might email passwords or personal data (not ideal, but people do), consider adding a check or disclaimer. Also, since we log email content in SharePoint, that data is now persistent; follow your company’s data retention policy (you might need to purge old entries after some time).

**6. Security Considerations:** Copilot Studio adheres to strong security and compliance standards (as noted, it supports things like geographic data residency, compliance certifications, etc.[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio)). Still, treat your agent as you would any application handling company data. Use **Microsoft Entra ID** (Azure AD) to manage who can configure the agent and flows[6](https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-configure-a-copilot-studio-agent-to-send-e/db208d05-8896-4927-9509-eaba01928f25). The agent itself will only be accessible through the channels you publish – in our case, via the email flow – so unauthorized users can’t directly talk to it unless they have the email address. If that email is internal only, you have an access control by virtue of who knows it. If it’s public, be prepared that external people might email it; if that’s not desired, perhaps only allow emails from your domain (you could set the flow trigger to ignore external senders or auto-reply that it’s internal help only).

**7. Performance and Scaling:** Monitor if the agent is keeping up with demand. If the volume grows, you might hit email send limits or API quotas. You can scale by distributing load or upgrading plans. The Copilot Studio capacity model counts the number of actions, so high volume might require more capacity licensing. Also ensure the mailbox used can handle many emails (an Office 365 mailbox typically can send up to some threshold per minute/hour). If needed, consider rate-limiting the flow or queuing requests (in extreme cases).

**8. Continuous Learning:** After deploying, gather metrics on success. For example, track the ratio of answered vs escalated queries (this is essentially the **deflection rate** – how many inquiries were deflected from needing a human). Aim to improve that over time by analyzing escalations. If many escalations are about a particular topic, maybe add that info to the bot’s knowledge or create a specialized topic for it. Copilot Studio might provide an **“insights”** dashboard highlighting frequent unknown intents or customer satisfaction (if you choose to collect feedback). Use those insights to make iterative improvements.

**9. Real-World Examples:** It helps to follow patterns from successful deployments. As mentioned, **ABN AMRO Bank** implemented a Copilot Studio agent (“Abby”) for internal IT helpdesk and other employee queries. They replaced their older bot with Abby and found it could handle more complex questions while reducing transfers to humans, leading to better service and lower costs[10](https://learn.microsoft.com/en-us/power-platform/guidance/case-studies/abn-amro-enhances-ai)[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio). In another case, **Solgari** (a communications solutions provider) built a customer-facing chatbot on Copilot Studio for their clients. It engages users on their website 24/7 and seamlessly offers escalation to live agents when needed[11](https://www.technologyrecord.com/article/solgari-launches-chatbot-powered-by-microsoft-copilot-studio). According to Solgari’s CTO, this approach streamlines routine interactions and still ensures humans can step in for complex issues[11](https://www.technologyrecord.com/article/solgari-launches-chatbot-powered-by-microsoft-copilot-studio). These examples show that a well-designed Copilot Studio agent can effectively handle millions of interactions, as long as it’s well-integrated and monitored. It’s encouraging to know our email bot uses the same technology that enterprises are trusting for mission-critical support.

**10. Future Enhancements:** Once the email agent is running smoothly, you can extend its capabilities:
    - *Additional Channels:* Deploy the same agent to Microsoft Teams as a chat bot for real-time Q&A, or integrate it into a web portal for users who prefer chatting over email. Copilot Studio supports multi-channel publishing easily.
    - *Broader Topics:* Expand the scope of the agent to cover more subjects (maybe other IT topics, or even HR FAQs if that makes sense), essentially evolving it into a general helpdesk bot.
    - *Proactive Features:* Use scheduled agent flows to send out useful info. For example, if you have common queries about system outages, the agent could proactively email updates (“This is your Copilot Assistant: we are aware of a CRM outage at the moment...”) to deflect incoming tickets.
    - *Integration with voice:* Dynamics 365 Contact Center includes voice channels. In the future, a similar agent could be connected to a voice bot (IVR) – callers could speak their question and the AI could either answer with text-to-speech or route to a person. ABN AMRO’s customer agent handled 1.5 million voice conversations per year using such integration[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio)[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio).
    - *Richer Ticketing:* If the SharePoint log becomes too limiting, consider moving to a full ITSM solution. Copilot Studio could directly create tickets in whatever system and even close them if resolved by AI. Microsoft is continuously improving Copilot Studio; upcoming features may include more direct channel integrations (perhaps an Email channel connector eventually) which could simplify our flow logic.

---

## Conclusion

Creating an autonomous agent with Copilot Studio to handle incoming emails is a powerful way to improve support efficiency and consistency. In our example, we built a virtual support assistant that can autonomously answer questions on Dynamics 365 Customer Service, Contact Center, and Copilot Studio itself, leveraging curated knowledge to provide accurate answers. It seamlessly logs each interaction in a SharePoint list as a ticket for accountability, and knows to **escalate to a human agent** when a question is outside its capabilities or a user needs personal assistance.

By following the steps outlined – configuring the agent with the right knowledge and instructions, integrating an email trigger and response flow, and setting up a robust escalation process – you can deploy a similar solution in your organization. The result is a faster response for users (immediate answers to common questions, even outside of business hours) and reduced workload on your support team (the AI handles routine queries and documentation).

Keep in mind that a Copilot Studio agent is not “set and forget.” **Ongoing training, monitoring, and refining** are key to long-term success. Treat it as a virtual team member who needs guidance and evaluation. With careful tuning, the agent will grow more effective over time, increasing the percentage of inquiries it can resolve on its own (this is referred to as improving the **deflection rate**). And when it does escalate, it does so with context, making the human agent’s job easier.

In deploying your autonomous agent, you’re joining early adopters at the forefront of AI in customer service and IT support. Businesses like Marcel McCann’s and Bobby van Groningen’s organizations have already seen the benefits of Copilot Studio – from 24/7 customer engagement with live agent hand-off[11](https://www.technologyrecord.com/article/solgari-launches-chatbot-powered-by-microsoft-copilot-studio) to handling millions of inquiries across multiple languages while maintaining strict security and reducing costs[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio)[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio). Your new email copilot can similarly transform the support experience within your team or for your customers, providing faster help and freeing humans to focus on the toughest problems.

With this foundation in place, you can continue to extend and enhance the agent. By integrating further with Dynamics 365 and other systems, your copilot can become an indispensable **digital assistant** that not only answers questions but also takes actions and delivers personalized support. Embrace the continuous learning process, and your autonomous agent will keep getting better, delivering reliable service hand-in-hand with your human experts.

**Next Steps:**  
- If you’re new to Copilot Studio, consider exploring Microsoft’s training module *“Build an autonomous agent in Copilot Studio”* on Microsoft Learn for hands-on guidance[11](https://www.technologyrecord.com/article/solgari-launches-chatbot-powered-by-microsoft-copilot-studio).  
- Review the **Copilot Studio documentation** and **Dynamics 365 Copilot integration guides** for in-depth technical settings (like enabling Copilot Studio knowledge in Customer Service, or configuring Omnichannel hand-off)[2](https://learn.microsoft.com/en-us/dynamics365/contact-center/administer/knowledge-copilot)[5](https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-hand-off).  
- Plan a pilot deployment, gather feedback from users and support staff, and iterate. Involve your cloud admin and security team early to address any compliance considerations (as ABN AMRO did with their CISO team[1](https://www.microsoft.com/en/customers/story/19754-abn-amro-bank-microsoft-copilot-studio)).  
- Finally, stay updated on new Copilot Studio features – Microsoft is rapidly evolving the platform (for example, new actions, channels, or analytics features might emerge) which could further enhance your agent’s capabilities.

By leveraging Copilot Studio to its fullest, you’re empowering your organization with an AI agent that works tirelessly to handle inquiries – a true autonomous assistant that can scale your support operations to new heights. Good luck with building your autonomous agent! 

